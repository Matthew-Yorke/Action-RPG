//***************************************************************************************************************************************************
//
// File Name: PlayerCharacter.cpp
//
// Description:
//  TODO: Add file description.
//
// Change History:
//  Author               Date           Description
//  Matthew D. Yorke     MM/DD/2018     TODO: Add history update
//
//***************************************************************************************************************************************************

#include <allegro5/allegro_primitives.h>
#include "PlayerCharacter.h"
#include "IdleState.h"

//***************************************************************************************************************************************************
// Start Public Method Definitions
//***************************************************************************************************************************************************

//***************************************************************************************************************************************************
//
// Method Name: PlayerCharacter
//
// Description:
//  TODO: Add method description.
//
//***************************************************************************************************************************************************
PlayerCharacter::PlayerCharacter(Graphics& theGraphics, int theCoordinateX, int theCoordinateY) :
RectangleObject(theCoordinateX, theCoordinateY, 64, 64)
{
   mCurrentHealth = mMaxHealth = 10;
   mCurrentMana = mMaxMana = 5;
   mpVelocity = new Vector2D(2.0F,
                             2.0F);
   mpSprite = new AnimatedSprite(theGraphics,
                                 "../Images/test.png",
                                 0,
                                 0,
                                 64,
                                 64,
                                 6,
                                 4);
   //mpHitbox = new Rectangle(theCoordinateX + 10,
   //                         theCoordinateY,
   //                         12,
   //                         32);
   mpMeleeWeapon = new MeleeWeapon(theGraphics,
                                   1,
                                   0,
                                   0,
                                   118,
                                   160);
   mpCurrentState = new IdleState(this);
   mDirection = PlayerConstants::DIRECTION::DOWN;
}

//***************************************************************************************************************************************************
//
// Method Name: ~PlayerCharacter
//
// Description:
//  TODO: Add method description.
//
//***************************************************************************************************************************************************
PlayerCharacter::~PlayerCharacter()
{
   delete mpVelocity;
   delete mpSprite;
   delete mpHitbox;
   delete mpMeleeWeapon;
}

//************************************************************************************************************************************************
//
// Method Name: GetDirection
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
PlayerConstants::DIRECTION PlayerCharacter::GetDirection()
{
   return mDirection;
}

//************************************************************************************************************************************************
//
// Method Name: SetDirection
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::SetDirection(PlayerConstants::DIRECTION theDirection)
{
   mDirection = theDirection; mpMeleeWeapon->SetDirection(theDirection);
}

//************************************************************************************************************************************************
//
// Method Name: InsertMovementDirection
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::InsertMovementDirection(PlayerConstants::DIRECTION theDirection)
{
   mMovingDirectionVector.insert(mMovingDirectionVector.begin(),
                                 theDirection);
}

//************************************************************************************************************************************************
//
// Method Name: RemoveMovementDirection
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::RemoveMovementDirection(PlayerConstants::DIRECTION theDirection)
{
   mMovingDirectionVector.erase(std::remove(mMovingDirectionVector.begin(),
                                            mMovingDirectionVector.end(),
                                            theDirection),
                                mMovingDirectionVector.end());
}

//************************************************************************************************************************************************
//
// Method Name: IsMovingDirectionEmpty
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
bool PlayerCharacter::IsMovingDirectionEmpty()
{
   return mMovingDirectionVector.empty();
}

//************************************************************************************************************************************************
//
// Method Name: IsMovingDirectionEmpty
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
PlayerConstants::DIRECTION PlayerCharacter::GetFrontOfMovingDirectionVector()
{
   return mMovingDirectionVector.front();
}

//************************************************************************************************************************************************
//
// Method Name: GetVelocity
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
Vector2D* PlayerCharacter::GetVelocity()
{
   return mpVelocity;
}

//************************************************************************************************************************************************
//
// Method Name: GetSprite
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
AnimatedSprite* PlayerCharacter::GetSprite()
{
   return mpSprite;
}

//************************************************************************************************************************************************
//
// Method Name: GetMeleeWeapon
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
MeleeWeapon* PlayerCharacter::GetMeleeWeapon()
{
   return mpMeleeWeapon;
}

//************************************************************************************************************************************************
//
// Method Name: ChangeState
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::ChangeState(State* theState)
{
   delete mpCurrentState;
   mpCurrentState = theState;
}

//************************************************************************************************************************************************
//
// Method Name: KeyDown
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::KeyDown(ALLEGRO_EVENT theEvent)
{
   mpCurrentState->KeyDown(theEvent);
}

//************************************************************************************************************************************************
//
// Method Name: KeyUp
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::KeyUp(ALLEGRO_EVENT theEvent)
{
   mpCurrentState->KeyUp(theEvent);
}

//************************************************************************************************************************************************
//
// Method Name: Update
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::Update(float theTimeChange)
{
   mpCurrentState->Update(theTimeChange);
}

//************************************************************************************************************************************************
//
// Method Name: Draw
//
// Description:
//  TODO: Add description.
//
//************************************************************************************************************************************************
void PlayerCharacter::Draw(Graphics& theGraphics)
{
   mpCurrentState->Draw(theGraphics);
}

//************************************************************************************************************************************************
//
// Method Name: DrawSprite
//
// Description:
//  TODO: Add description.
//
// Arguments:
//  theGraphics - TODO: Add description.
//
// Return:
//  N/A
//
//************************************************************************************************************************************************
void PlayerCharacter::DrawSprite(Graphics& theGraphics)
{
   mpSprite->Draw(theGraphics,
                  GetCoordinateX(),
                  GetCoordinateY());
}

//***************************************************************************************************************************************************
// End Public Method Definitions
//***************************************************************************************************************************************************

//***************************************************************************************************************************************************
// Start Protected Method Definitions
//***************************************************************************************************************************************************



//***************************************************************************************************************************************************
// End Protected Method Definitions
//***************************************************************************************************************************************************

//***************************************************************************************************************************************************
// Start Private Method Definitions
//***************************************************************************************************************************************************



//***************************************************************************************************************************************************
// End Private Method Definitions
//***************************************************************************************************************************************************